<?xml version="1.0" encoding="UTF-8" ?>

<!DOCTYPE sqlMap      
    PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN"      
    "http://ibatis.apache.org/dtd/sql-map-2.dtd">
    
<sqlMap namespace="board">

	<typeAlias alias="boardDTO" type="com.board.BoardDTO"/>

	<select id="maxBoardNum" resultClass="int" >
		select nvl(max(boardNum),0) from bbs
	</select>

	<insert id="insertData" parameterClass="boardDTO">
		insert into bbs (boardNum,name,pwd,email,subject,content,ipAddr,
		groupNum,orderNo,depth,parent,hitCount,created) values(#boardNum#,
		#name#,#pwd#,#email#,#subject#,#content#,#ipAddr#,
		#groupNum#,#orderNo#,#depth#,#parent#,0,sysdate)
	</insert>
	
	<select id="dataCount" resultClass="int" parameterClass="map">
		select nvl(count(*),0) from bbs
		where $searchKey$ like '%' || #searchKey# || '%'
	</select>
	
	<select id="listData" resultClass="boardDTO" parameterClass="map">

		select * from(
		select rownum rnum, data.*(
		select boardNum,name,subject,depth,hitCount,
		to_char(created,'YYYY-MM-DD') created from bbs
		where $searchKey$ like '%' || #searchKey# || '%'
		order by groupNum desc, orderNo asc) data)
	<![CDATA[
		where rnum >= #start# and rnum <= #end#
	]]>
	</select>
	

</sqlMap>
